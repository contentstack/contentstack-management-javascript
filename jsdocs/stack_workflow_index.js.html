<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>stack/workflow/index.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <link rel="canonical" href="https://www.contentstack.com/docs/developers/javascript-management/api-reference/">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-WGP99J7');</script>
    <!-- End Google Tag Manager -->
</head>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WGP99J7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="Contentstack.html">Contentstack</a><ul class='members'><li data-type='member'><a href="Contentstack.html#.client">client</a></li></ul></li><li><a href="ContentstackClient.html">ContentstackClient</a><ul class='methods'><li data-type='method'><a href="ContentstackClient.html#.login">login</a></li><li data-type='method'><a href="ContentstackClient.html#.getUser">getUser</a></li><li data-type='method'><a href="ContentstackClient.html#.stack">stack</a></li><li data-type='method'><a href="ContentstackClient.html#.organization">organization</a></li><li data-type='method'><a href="ContentstackClient.html#.logout">logout</a></li></ul></li><li><a href="User.html">User</a><ul class='methods'><li data-type='method'><a href="User.html#.update">update</a></li><li data-type='method'><a href="User.html#.delete">delete</a></li><li data-type='method'><a href="User.html#.requestPassword">requestPassword</a></li><li data-type='method'><a href="User.html#.resetPassword">resetPassword</a></li><li data-type='method'><a href="User.html#.getTasks">getTasks</a></li></ul></li><li><a href="Organization.html">Organization</a><ul class='methods'><li data-type='method'><a href="Organization.html#.fetch">fetch</a></li><li data-type='method'><a href="Organization.html#.stacks">stacks</a></li><li data-type='method'><a href="Organization.html#.transferOwnership">transferOwnership</a></li><li data-type='method'><a href="Organization.html#.addUser">addUser</a></li><li data-type='method'><a href="Organization.html#.getInvitations">getInvitations</a></li><li data-type='method'><a href="Organization.html#.resendInvitition">resendInvitition</a></li><li data-type='method'><a href="Organization.html#.roles">roles</a></li><li data-type='method'><a href="Organization.html#.fetchAll">fetchAll</a></li></ul></li><li><a href="Stack.html">Stack</a><ul class='methods'><li data-type='method'><a href="Stack.html#.update">update</a></li><li data-type='method'><a href="Stack.html#.fetch">fetch</a></li><li data-type='method'><a href="Stack.html#contentType">contentType</a></li><li data-type='method'><a href="Stack.html#locale">locale</a></li><li data-type='method'><a href="Stack.html#asset">asset</a></li><li data-type='method'><a href="Stack.html#globalField">globalField</a></li><li data-type='method'><a href="Stack.html#environment">environment</a></li><li data-type='method'><a href="Stack.html#branch">branch</a></li><li data-type='method'><a href="Stack.html#branchAlias">branchAlias</a></li><li data-type='method'><a href="Stack.html#deliveryToken">deliveryToken</a></li><li data-type='method'><a href="Stack.html#extension">extension</a></li><li data-type='method'><a href="Stack.html#workflow">workflow</a></li><li data-type='method'><a href="Stack.html#webhook">webhook</a></li><li data-type='method'><a href="Stack.html#label">label</a></li><li data-type='method'><a href="Stack.html#release">release</a></li><li data-type='method'><a href="Stack.html#bulkOperation">bulkOperation</a></li><li data-type='method'><a href="Stack.html#.users">users</a></li><li data-type='method'><a href="Stack.html#.transferOwnership">transferOwnership</a></li><li data-type='method'><a href="Stack.html#.settings">settings</a></li><li data-type='method'><a href="Stack.html#.resetSettings">resetSettings</a></li><li data-type='method'><a href="Stack.html#.addSettings">addSettings</a></li><li data-type='method'><a href="Stack.html#.share">share</a></li><li data-type='method'><a href="Stack.html#.unShare">unShare</a></li><li data-type='method'><a href="Stack.html#.role">role</a></li><li data-type='method'><a href="Stack.html#.create">create</a></li><li data-type='method'><a href="Stack.html#.query">query</a></li></ul></li><li><a href="ContentType.html">ContentType</a><ul class='methods'><li data-type='method'><a href="ContentType.html#.update">update</a></li><li data-type='method'><a href="ContentType.html#.delete">delete</a></li><li data-type='method'><a href="ContentType.html#.fetch">fetch</a></li><li data-type='method'><a href="ContentType.html#entry">entry</a></li><li data-type='method'><a href="ContentType.html#.generateUid">generateUid</a></li><li data-type='method'><a href="ContentType.html#.create">create</a></li><li data-type='method'><a href="ContentType.html#.query">query</a></li><li data-type='method'><a href="ContentType.html#.import">import</a></li></ul></li><li><a href="GlobalField.html">GlobalField</a><ul class='methods'><li data-type='method'><a href="GlobalField.html#.update">update</a></li><li data-type='method'><a href="GlobalField.html#.delete">delete</a></li><li data-type='method'><a href="GlobalField.html#.fetch">fetch</a></li><li data-type='method'><a href="GlobalField.html#.create">create</a></li><li data-type='method'><a href="GlobalField.html#.query">query</a></li><li data-type='method'><a href="GlobalField.html#.import">import</a></li></ul></li><li><a href="Entry.html">Entry</a><ul class='methods'><li data-type='method'><a href="Entry.html#.update">update</a></li><li data-type='method'><a href="Entry.html#.delete">delete</a></li><li data-type='method'><a href="Entry.html#.fetch">fetch</a></li><li data-type='method'><a href="Entry.html#.publish">publish</a></li><li data-type='method'><a href="Entry.html#.unpublish">unpublish</a></li><li data-type='method'><a href="Entry.html#.publishRequest">publishRequest</a></li><li data-type='method'><a href="Entry.html#.create">create</a></li><li data-type='method'><a href="Entry.html#.query">query</a></li><li data-type='method'><a href="Entry.html#.import">import</a></li></ul></li><li><a href="Asset.html">Asset</a><ul class='methods'><li data-type='method'><a href="Asset.html#.update">update</a></li><li data-type='method'><a href="Asset.html#.delete">delete</a></li><li data-type='method'><a href="Asset.html#.fetch">fetch</a></li><li data-type='method'><a href="Asset.html#.replace">replace</a></li><li data-type='method'><a href="Asset.html#.publish">publish</a></li><li data-type='method'><a href="Asset.html#.unpublish">unpublish</a></li><li data-type='method'><a href="Asset.html#.folder">folder</a></li><li data-type='method'><a href="Asset.html#.create">create</a></li><li data-type='method'><a href="Asset.html#.query">query</a></li></ul></li><li><a href="Folder.html">Folder</a><ul class='methods'><li data-type='method'><a href="Folder.html#.update">update</a></li><li data-type='method'><a href="Folder.html#.delete">delete</a></li><li data-type='method'><a href="Folder.html#.fetch">fetch</a></li><li data-type='method'><a href="Folder.html#.create">create</a></li></ul></li><li><a href="BulkOperation.html">BulkOperation</a><ul class='methods'><li data-type='method'><a href="BulkOperation.html#.publish">publish</a></li><li data-type='method'><a href="BulkOperation.html#.unpublish">unpublish</a></li><li data-type='method'><a href="BulkOperation.html#.delete">delete</a></li></ul></li><li><a href="Extension.html">Extension</a><ul class='methods'><li data-type='method'><a href="Extension.html#.update">update</a></li><li data-type='method'><a href="Extension.html#.delete">delete</a></li><li data-type='method'><a href="Extension.html#.fetch">fetch</a></li><li data-type='method'><a href="Extension.html#.upload">upload</a></li><li data-type='method'><a href="Extension.html#.create">create</a></li><li data-type='method'><a href="Extension.html#.query">query</a></li></ul></li><li><a href="Release.html">Release</a><ul class='methods'><li data-type='method'><a href="Release.html#.update">update</a></li><li data-type='method'><a href="Release.html#.fetch">fetch</a></li><li data-type='method'><a href="Release.html#.delete">delete</a></li><li data-type='method'><a href="Release.html#.item">item</a></li><li data-type='method'><a href="Release.html#.deploy">deploy</a></li><li data-type='method'><a href="Release.html#.clone">clone</a></li><li data-type='method'><a href="Release.html#.create">create</a></li><li data-type='method'><a href="Release.html#.query">query</a></li></ul></li><li><a href="Label.html">Label</a><ul class='methods'><li data-type='method'><a href="Label.html#.update">update</a></li><li data-type='method'><a href="Label.html#.delete">delete</a></li><li data-type='method'><a href="Label.html#.fetch">fetch</a></li><li data-type='method'><a href="Label.html#.create">create</a></li><li data-type='method'><a href="Label.html#.query">query</a></li></ul></li><li><a href="Locale.html">Locale</a><ul class='methods'><li data-type='method'><a href="Locale.html#.update">update</a></li><li data-type='method'><a href="Locale.html#.delete">delete</a></li><li data-type='method'><a href="Locale.html#.fetch">fetch</a></li><li data-type='method'><a href="Locale.html#.create">create</a></li><li data-type='method'><a href="Locale.html#.query">query</a></li></ul></li><li><a href="Environment.html">Environment</a><ul class='methods'><li data-type='method'><a href="Environment.html#.update">update</a></li><li data-type='method'><a href="Environment.html#.delete">delete</a></li><li data-type='method'><a href="Environment.html#.fetch">fetch</a></li><li data-type='method'><a href="Environment.html#.create">create</a></li><li data-type='method'><a href="Environment.html#.query">query</a></li></ul></li><li><a href="DeliveryToken.html">DeliveryToken</a><ul class='methods'><li data-type='method'><a href="DeliveryToken.html#.update">update</a></li><li data-type='method'><a href="DeliveryToken.html#.delete">delete</a></li><li data-type='method'><a href="DeliveryToken.html#.fetch">fetch</a></li><li data-type='method'><a href="DeliveryToken.html#.create">create</a></li><li data-type='method'><a href="DeliveryToken.html#.query">query</a></li></ul></li><li><a href="Role.html">Role</a><ul class='methods'><li data-type='method'><a href="Role.html#.update">update</a></li><li data-type='method'><a href="Role.html#.delete">delete</a></li><li data-type='method'><a href="Role.html#.fetch">fetch</a></li><li data-type='method'><a href="Role.html#.create">create</a></li><li data-type='method'><a href="Role.html#.findAll">findAll</a></li><li data-type='method'><a href="Role.html#.query">query</a></li></ul></li><li><a href="Webhook.html">Webhook</a><ul class='methods'><li data-type='method'><a href="Webhook.html#.update">update</a></li><li data-type='method'><a href="Webhook.html#.delete">delete</a></li><li data-type='method'><a href="Webhook.html#.fetch">fetch</a></li><li data-type='method'><a href="Webhook.html#.executions">executions</a></li><li data-type='method'><a href="Webhook.html#retry">retry</a></li><li data-type='method'><a href="Webhook.html#.create">create</a></li><li data-type='method'><a href="Webhook.html#.fetchAll">fetchAll</a></li><li data-type='method'><a href="Webhook.html#.import">import</a></li></ul></li><li><a href="Workflow.html">Workflow</a><ul class='methods'><li data-type='method'><a href="Workflow.html#.update">update</a></li><li data-type='method'><a href="Workflow.html#.disable">disable</a></li><li data-type='method'><a href="Workflow.html#.enable">enable</a></li><li data-type='method'><a href="Workflow.html#.delete">delete</a></li><li data-type='method'><a href="Workflow.html#.fetch">fetch</a></li><li data-type='method'><a href="Workflow.html#.getPublishRules">getPublishRules</a></li><li data-type='method'><a href="Workflow.html#.create">create</a></li><li data-type='method'><a href="Workflow.html#.fetchAll">fetchAll</a></li><li data-type='method'><a href="Workflow.html#.publishRule">publishRule</a></li></ul></li><li><a href="PublishRules.html">PublishRules</a><ul class='methods'><li data-type='method'><a href="PublishRules.html#.create">create</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">stack/workflow/index.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import cloneDeep from 'lodash/cloneDeep'
import {
  create,
  update,
  deleteEntity,
  fetch,
  fetchAll
} from '../../entity'
import error from '../../core/contentstackError'
import ContentstackCollection from '../../contentstackCollection'
import { PublishRules, PublishRulesCollection } from './publishRules'

/**
 * Workflow is a tool that allows you to streamline the process of content creation and publishing, and lets you manage the content lifecycle of your project smoothly. Read more about &lt;a href='https://www.contentstack.com/docs/developers/set-up-workflows-and-publish-rules'>Workflows and Publish Rules&lt;/a>.
 * @namespace Workflow
 */

export function Workflow (http, data = {}) {
  this.stackHeaders = data.stackHeaders
  this.urlPath = `/workflows`

  if (data.workflow) {
    Object.assign(this, cloneDeep(data.workflow))
    this.urlPath = `/workflows/${this.uid}`

    /**
     * @description The Update Workflow request allows you to add a workflow stage or update the details of the existing stages of a workflow.
     * @memberof Workflow
     * @func update
     * @returns {Promise&lt;Workflow.Workflow>} Promise for Workflow instance
     * @example
     * import * as contentstack from '@contentstack/management'
     * const client = contentstack.client()
     *
     * client.stack({ api_key: 'api_key'}).workflow('workflow_uid').fetch()
     * .then((workflow) => {
     *  workflow.name = 'My New Workflow'
     *  workflow.description = 'Workflow description'
     *  return workflow.update()
     * })
     * .then((workflow) => console.log(workflow))
     *
     */
    this.update = update(http, 'workflow')

    /**
     * @description The Disable Workflow request allows you to disable a workflow.
     * @memberof Workflow
     * @func disable
     * @returns {Promise&lt;Workflow.Workflow>} Promise for Workflow instance
     * @example
     * import * as contentstack from '@contentstack/management'
     * const client = contentstack.client()
     *
     * client.stack({ api_key: 'api_key'}).workflow('workflow_uid').disable()
     * .then((workflow) => console.log(workflow))
     *
     */
    this.disable = async function () {
      try {
        const response = await http.get(`/workflows/${this.uid}/disable`, {
          headers: {
            ...cloneDeep(this.stackHeaders)
          }
        })
        if (response.data) {
          return response.data
        } else {
          throw error(response)
        }
      } catch (err) {
        throw error(err)
      }
    }

    /**
     * @description The Enable Workflow request allows you to enable a workflow.
     * @memberof Workflow
     * @func enable
     * @returns {Promise&lt;Workflow.Workflow>} Promise for Workflow instance
     * @example
     * import * as contentstack from '@contentstack/management'
     * const client = contentstack.client()
     *
     * client.stack({ api_key: 'api_key'}).workflow('workflow_uid').enable()
     * .then((workflow) => console.log(workflow))
     *
     */
    this.enable = async function () {
      try {
        const response = await http.get(`/workflows/${this.uid}/enable`, {
          headers: {
            ...cloneDeep(this.stackHeaders)
          }
        })
        if (response.data) {
          return response.data
        } else {
          throw error(response)
        }
      } catch (err) {
        throw error(err)
      }
    }

    /**
     * @description The Delete Workflow call is used to delete an existing Workflow permanently from your Stack.
     * @memberof Workflow
     * @func delete
     * @returns {Object} Response Object.
     * @example
     * import * as contentstack from '@contentstack/management'
     * const client = contentstack.client()
     *
     * client.stack({ api_key: 'api_key'}).workflow('workflow_uid').delete()
     * .then((response) => console.log(response.notice))
     */
    this.delete = deleteEntity(http)

    /**
     * @description The fetch workflow retrieves the comprehensive details of a specific Workflow of a stack.
     * @memberof Workflow
     * @func fetch
     * @returns {Promise&lt;Workflow.Workflow>} Promise for Workflow instance
     * @example
     * import * as contentstack from '@contentstack/management'
     * const client = contentstack.client()
     *
     * client.stack({ api_key: 'api_key'}).workflow('workflow_uid').fetch()
     * .then((workflow) => console.log(workflow))
     *
     */
    this.fetch = fetch(http, 'workflow')
  } else {
    this.contentType = (contentTypeUID) => {
      if (contentTypeUID) {
        /**
             * @description The Delete Workflow call is used to delete an existing Workflow permanently from your Stack.
             * @memberof Workflow
             * @func getPublishRules
             * @returns {Object} Returns Object.
             * @param {string} action Enter the action that has been set in the Publishing Rule. Example:publish/unpublish
             * @param {string} locale Enter the code of the locale where your Publishing Rule will be applicable.
             * @param {string} environment Enter the UID of the environment where your Publishing Rule will be applicable.
             * @returns {ContentstackCollection} Result collection of content of PublishRules.
             * @example
             * import * as contentstack from '@contentstack/management'
             * const client = contentstack.client()
             *
             * client.stack({ api_key: 'api_key'}).workflow('workflow_uid').contentType('contentType_uid').getPublishRules()
             * .then((collection) => console.log(collection))
             */
        const getPublishRules = async function (params) {
          const headers = {}
          if (this.stackHeaders) {
            headers.headers = this.stackHeaders
          }
          if (params) {
            headers.params = {
              ...cloneDeep(params)
            }
          }
          try {
            const response = await http.get(`/workflows/content_type/${contentTypeUID}`, headers)
            if (response.data) {
              return new ContentstackCollection(response, http, this.stackHeaders, PublishRulesCollection)
            } else {
              throw error(response)
            }
          } catch (err) {
            throw error(err)
          }
        }
        return {
          getPublishRules,
          stackHeaders: { ...this.stackHeaders }
        }
      }
    }
    /**
     * @description The Create a Workflow request allows you to create a Workflow.
     * @memberof Workflow
     * @func create
     * @returns {Promise&lt;Workflow.Workflow>} Promise for Workflow instance
     *
     * @example
     * import * as contentstack from '@contentstack/management'
     * const client = contentstack.client()
     *
     * const workflow = {
     *"workflow_stages": [
     *      {
     *        "color": "#2196f3",
     *        "SYS_ACL": {
     *          "roles": {
     *            "uids": []
     *          },
     *          "users": {
     *          "uids": [
     *            "$all"
     *          ]
     *        },
     *        "others": {}
     *      },
     *      "next_available_stages": [
     *        "$all"
     *      ],
     *      "allStages": true,
     *      "allUsers": true,
     *      "specificStages": false,
     *      "specificUsers": false,
     *      "entry_lock": "$none", //assign any one of the assign any one of the ($none/$others/$all)
     *      "name": "Review"
     *    },
     *    {
     *      "color": "#74ba76",
     *      "SYS_ACL": {
     *        "roles": {
     *          "uids": []
     *        },
     *        "users": {
     *          "uids": [
     *            "$all"
     *          ]
     *        },
     *        "others": {}
     *      },
     *      "allStages": true,
     *      "allUsers": true,
     *      "specificStages": false,
     *      "specificUsers": false,
     *      "next_available_stages": [
     *          "$all"
     *        ],
     *        "entry_lock": "$none",
     *        "name": "Complete"
     *      }
     *    ],
     *    "admin_users": {
     *      "users": []
     *    },
     *      "name": "Workflow Name",
     *      "enabled": true,
     *      "content_types": [
     *        "$all"
     *      ]
     *  }
     *  client.stack().workflow().create({ workflow })
     * .then((workflow) => console.log(workflow))
     */
    this.create = create({ http: http })

    /**
     * @description The Get all Workflows request retrieves the details of all the Workflows of a stack.
     * @memberof Workflow
     * @func fetchAll
     * @param {Int} limit The limit parameter will return a specific number of Workflows in the output.
     * @param {Int} skip The skip parameter will skip a specific number of Workflows in the output.
     * @param {Boolean}include_count To retrieve the count of Workflows.
     * @returns {ContentstackCollection} Result collection of content of specified module.
     * @example
     * import * as contentstack from '@contentstack/management'
     * const client = contentstack.client()
     *
     * client.stack({ api_key: 'api_key'}).workflow().fetchAll()
     * .then((collection) => console.log(collection))
     *
     */
    this.fetchAll = fetchAll(http, WorkflowCollection)

    /**
     * @description The Publish rule allow you to create, fetch, delete, update the publish rules.
     * @memberof Workflow
     * @func publishRule
     * @param {Int} ruleUid The UID of the Publish rules you want to get details.
     * @returns {PublishRules} Instace of PublishRules.
     * @example
     * import * as contentstack from '@contentstack/management'
     * const client = contentstack.client()
     *
     * client.stack({ api_key: 'api_key'}).workflow().publishRule().fetchAll()
     * .then((collection) => console.log(collection))
     *
     * client.stack({ api_key: 'api_key'}).workflow().publishRule('rule_uid').fetch()
     * .then((publishrule) => console.log(publishrule))
     *
     */
    this.publishRule = (ruleUid = null) => {
      const publishInfo = { stackHeaders: this.stackHeaders }
      if (ruleUid) {
        publishInfo.publishing_rule = { uid: ruleUid }
      }
      return new PublishRules(http, publishInfo)
    }
  }
}

export function WorkflowCollection (http, data) {
  const obj = cloneDeep(data.workflows) || []
  const workflowCollection = obj.map((userdata) => {
    return new Workflow(http, { workflow: userdata, stackHeaders: data.stackHeaders })
  })
  return workflowCollection
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.5</a> on Tue May 25 2021 12:41:11 GMT+0530 (India Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
